{% extends 'admin/master.html' %}

{% block body %}
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <h2>📊 Database Statistics & Health</h2>
            <hr>
            
            <!-- Database Info -->
            <div class="row">
                <div class="col-md-6">
                    <div class="panel panel-info">
                        <div class="panel-heading">
                            <h3 class="panel-title">🗄️ Database Information</h3>
                        </div>
                        <div class="panel-body">
                            <p><strong>Database Path:</strong> <code>{{ db_path }}</code></p>
                            <p><strong>Database Size:</strong> {{ db_size }}</p>
                            <p><strong>Type:</strong> SQLite</p>
                            <p><strong>Last Updated:</strong> <span id="current-time"></span></p>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="panel panel-success">
                        <div class="panel-heading">
                            <h3 class="panel-title">📈 Quick Actions</h3>
                        </div>
                        <div class="panel-body">
                            <button class="btn btn-primary btn-sm" onclick="location.reload()">
                                🔄 Refresh Data
                            </button>
                            <a href="/admin/user/" class="btn btn-info btn-sm">
                                👥 View Users
                            </a>
                            <a href="/admin/scenario/" class="btn btn-success btn-sm">
                                📚 View Scenarios
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Table Statistics -->
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">📋 Table Record Counts</h3>
                        </div>
                        <div class="panel-body">
                            <div class="row">
                                {% for table_name, count in stats.items() %}
                                <div class="col-md-2 col-sm-4 col-xs-6">
                                    <div class="text-center">
                                        <div class="panel panel-primary" style="margin-bottom: 10px;">
                                            <div class="panel-body">
                                                <h2 class="text-primary">{{ count }}</h2>
                                                <p class="text-muted">{{ table_name }}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Live Updates -->
            <div class="row">
                <div class="col-md-12">
                    <div class="alert alert-info">
                        <strong>💡 Live Updates:</strong> This page shows real-time database statistics. 
                        Click "Refresh Data" to get the latest counts or navigate to specific tables to view/edit records.
                    </div>
                </div>
            </div>
            
        </div>
    </div>
</div>

<script>
// Update current time
document.getElementById('current-time').textContent = new Date().toLocaleString();

// Auto-refresh every 30 seconds
setTimeout(function() {
    location.reload();
}, 30000);
</script>
{% endblock %} 